#+title: Diverse Conventions
#+author: Bidipta Sarkar
#+email: bidiptas@stanford.edu
#+description: Diverse Conventions for Human-AI Collaboration
#+KEYWORDS: homepage, website, research, AI, RL, MARL
#+LANGUAGE:  en
#+OPTIONS: email:t toc:nil num:nil html-postamble:nil html-style:nil title:nil \n:t H:3
#+startup: inlineimages

#+HTML_HEAD: <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
#+HTML_HEAD: <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
#+HTML_HEAD: <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.css">
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="style.css"/>
#+HTML_HEAD: <link rel="stylesheet" type="text/css" href="bootstrap.min.css"/>

#+HTML_HEAD: <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
#+HTML_HEAD: <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
#+HTML_HEAD: <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.8.0/codemirror.min.js"></script>
#+HTML_HEAD: <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.3/clipboard.min.js"></script>
#+HTML_HEAD: <script src="js/app.js"></script>

#+EXPORT_FILE_NAME: index

#+PROPERTY:  header-args :eval never-export


#+html: <div id="main" class="container">



@@html:<div class="row"><h2 class="col-md-12 text-center"><strong><font size="+4r">@@ Diverse Conventions for Human-AI Collaboration @@html:</font></strong></h2></div>@@


#+html: <div class="row"> <div class="col-md-12 text-center">
#+attr_html: :class list-inline
- Bidipta Sarkar
- Andy Shih
- Dorsa Sadigh


@@html:<br><a href="https://stanford.edu"><image src="img/stanford_logo.png" height="55px"> </a><a href="http://iliad.stanford.edu"> <image src="img/iliad.png" height="40px"> </a><br>@@
#+html: </div> </div>


#+html: <div class="row"> <div class="col-md-4 col-md-offset-4 text-center">
#+attr_html: :class nav nav-pills nav-justified
- @@html:<a href="https://arxiv.org/abs/2310.15414"><image src="img/paper.png" height="60px"><h4><strong>Paper</strong></h4></a>@@
- @@html:<a href="https://github.com/Stanford-ILIAD/Diverse-Conventions"><image src="img/GitHub-Mark.png" height="60px"><h4><strong>Code</strong></h4></a>@@
- @@html:<a href="https://drive.google.com/drive/folders/1SY4X1kEJV8mD1Snb9_pkwiBsqGTf4bn1"><image src="img/dataset.svg" height="60px"><h4><strong>Interaction Data</strong></h4></a>@@

#+html: </div></div>

#+html: <div class="row"> <div class="col-md-8 col-md-offset-2">

* 

** Abstract

Conventions are crucial for strong performance in cooperative multi-agent games, because they allow players to coordinate on a shared strategy without explicit communication. Unfortunately, standard multi-agent reinforcement learning techniques, such as self-play, converge to conventions that are arbitrary and non-diverse, leading to poor generalization when interacting with new partners. In this work, we present a technique for generating diverse conventions by (1) maximizing their rewards during self-play, while (2) minimizing their rewards when playing with previously discovered conventions (cross-play), stimulating conventions to be semantically different. To ensure that learned policies act in good faith despite the adversarial optimization of cross-play, we introduce /mixed-play/, where an initial state is randomly generated by sampling self-play and cross-play transitions and the player learns to maximize the self-play reward from this initial state. We analyze the benefits of our technique on various multi-agent collaborative games, including Overcooked, and find that our technique can adapt to the conventions of humans, surpassing human-level performance when paired with real users.

** Human-AI Interaction Videos

In the following videos, a human controls the blue player while a trained AI controls the green player. Self-play and Statistical Diversity are baselines while XP and CoMeDi are our techniques.


** 
  :PROPERTIES:
  :html_container: div
  :html_container_class: irow
  :END:

*** CoMeDi (Ours)
  :PROPERTIES:
  :html_container: div
  :html_container_class: column
  :END:

  @@html:<video width="100%" controls> <source src="img/MP_new.mp4" type="video/mp4"> </video>@@


*** Cross-Play Min (XP)
  :PROPERTIES:
  :html_container: div
  :html_container_class: column
  :END:

  @@html:<video width="100%" controls> <source src="img/XP_new.mp4" type="video/mp4"> </video>@@


*** Statistical Diversity (ADAP)
  :PROPERTIES:
  :html_container: div
  :html_container_class: column
  :END:

  @@html:<video width="100%" controls> <source src="img/ADAP_new.mp4" type="video/mp4"> </video>@@


*** Self-Play (SP)
  :PROPERTIES:
  :html_container: div
  :html_container_class: column
  :END:

  @@html:<video width="100%" controls> <source src="img/SP_new.mp4" type="video/mp4"> </video>@@
  
#+html: </div>

** Overcooked Interaction Demo

In the space below, we have a live demo of the trained agents in Overcooked. You can select the AI under the "Algo" dropdown along with the layout. Use the arrow keys to move the agent and the space bar to interact with the object that your player is facing.

#+html: <div class="contentx">
#+BEGIN_export html
<style>
iframe {
  width: 100%;
height: 60em;
overflow: hidden;
margin: auto;
padding-top: 20px;
}
</style> 

<iframe src="https://cs.stanford.edu/~bidiptas/overcooked_demo/" scrolling="no"></iframe> 

<script>
parent.document.getElementsByTagName('iframe')[0].scrolling="no";
</script>
#+END_export
#+html: </div>
#+html:</div></div></div>


#+BEGIN_export html
<div class="row">
	  <div class="col-md-8 col-md-offset-2">
            <h3>
              Citation
            </h3>
            <div class="form-group col-md-10 col-md-offset-1">
              <textarea id="bibtex" class="form-control" readonly>@inproceedings{sarkar2023diverse,
	title={Diverse Conventions for Human-{AI} Collaboration},
	author={Bidipta Sarkar and Andy Shih and Dorsa Sadigh},
	booktitle={Thirty-seventh Conference on Neural Information Processing Systems},
	year={2023}
}</textarea>
            </div>
	  </div>
	  
	</div>

	<div class="row">
	  <div class="col-md-8 col-md-offset-2">
            <!-- <h3> -->
              <!--     Acknowledgements -->
              <!-- </h3> -->
            <p class="text-justify">
              <br><br>
              The website template was borrowed from <a href="http://jonbarron.info/">Jon Barron</a> and <a href="https://robotics-transformer.github.io/">RT-1</a>
            </p>
	  </div>
	</div>
#+END_export

# Local Variables:
# eval: (add-hook 'after-save-hook (lambda nil (when (y-or-n-p "Tangle?") (org-html-export-to-html))) nil t)
# End:
