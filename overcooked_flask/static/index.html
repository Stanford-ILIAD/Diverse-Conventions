<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    <title>Overcooked Demo</title>
    <link rel="Favicon" href="static/favicon.ico" />

    <script src="static/lib/jquery-min.js" type="text/javascript"> </script>
    <script src="static/lib/d3.v3.min.js" type="text/javascript"> </script>
    <script src="static/lib/babel.min.js" type="text/javascript"> </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <script src="static/js/demo/demo.js" type="text/javascript"> </script>

    <link rel="stylesheet" href="static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/css/style.css" type="text/css" />
  </head>
  <body>
    <div class='container' style="padding-top: 100px;">
      <h2>Overview of Overcooked</h2>

      <p>
	Thank you for participating in this user study! You will be playing a web-based game of Overcooked, a 2-player cooking simulator. Your goal is to try to serve as many dishes of onion soup as possible within a 40 second time limit. Below is an annotated diagram of the environment:
      </p>

      <p class="text-center"><img src="static/images/annotated-diagram.png" style="width:400px"></p>

      <h3>Movement and Interactions</h3>

      <p>
        You can move up, down, left, and right using
        the <b>arrow keys</b>, and interact with objects
        using the <b>spacebar</b>.
      </p>
      <p>
        You can interact with objects by facing them and pressing
        <b>spacebar</b>. Here are some examples:
        <ul>
          <li>You can pick up onions by facing
            the onion area and pressing <b>spacebar</b>.</li>
	  <li>You can pick up a plate by facing the plate area and pressing <b>spacebar</b>.</li>
          <li>If you are holding an item, are facing an empty counter,
            and press <b>spacebar</b>, you put that item on the counter.</li>
          <li>If you are holding an onion, are facing a pot that is not full,
            and press <b>spacebar</b>, you will put the onion in the pot.</li>
        </ul>
	As a reminder, you must <b><u>face</u></b> the object you are trying to interact with. 
      </p>

      <p>
        Note that as you and your partner are moving around the kitchen
        you <u>cannot occupy the same location</u>, so you have to coordinate the navigation with your partner.
      </p>

      <h3>Cooking</h3>

      <p class="text-center"><img src="static/images/soup.png" style="width:250px"></p>
      <p>
	To make soup, place <b>3 onions</b> in the pot and the timer will start counting up from 0. When the timer reaches 20, the soup is fully cooked. You must carry a <b>plate</b> to the pot and interact with the pot to fill the plate. Then, you can carry the plate back to the <b>serving counter</b>, and you will get <u>20 points</u>.
      </p>

      <p>Watch <a href='https://drive.google.com/file/d/1hfcgIWDA6lWFw3cNTyiW3vKDksj9u_qd/view' target="_blank">this video</a> for a demo of two users playing the game. (If the video doesn't play, you may have to allow third-party cookies.)</p>
      
      <h2>Your Task</h2>

      <p>You will be playing the Overcooked game in two different layouts: Cramped Room and Coordination Ring.</p>
      
      <p class="text-center">
	
	<img src="static/images/simple-ex.png" style="width:200px">
	<img src="static/images/coord-ex.png" style="width:200px">
	
      </p>

      <p> For each environment, you will first be given the chance to understand the layout by playing 2 games with no active AI partner. After this, you will play each of 4 trained AI's in the "Algo" dropdown <b>twice</b> (playing both games for a single Algo back-to-back) in the <b>order of the dropdown</b>. Each time you finish 2 games with an AI, you should fill out <a href="https://forms.gle/DqrE75gJPyjR1y3D6" target="_blank" rel="noopener noreferrer">this Google form</a> to provide feedback on the AI partner.</p>

      <p>After you have played with each agent twice on the Cramped Room layout, you will do the same process for the Coordination Ring layout.</p>

      <p>Here is an example interface:</p>

      <p class="text-center"><img src="static/images/ex-prompt.png" style="width:800px"></p>

      <p>The text below the gameplay reminds you to fill out the Google form and what configurations you have already finished playing. The <b>bold line</b> tells you what configuration to play. There are 2 layouts, 5 algos to choose from (including the "NO AI"), and you will play in each configuration twice, so in total you will play 20 rounds of Overcooked, each of which are 40 seconds long.</p>

      <p>For all configurations, your goal will be to get as high of a score as possible by serving the most soup in the 40 second time limit.</p>
      
      <!-- <h3>Instructions</h3> -->
      <!-- <p> -->
      <!--   In this task you will be playing a web-based game of Overcooked with 4 different AI agents (and a single-player version to get familiarized with the task). You will play with <b>each agent TWICE for each environment</b>. <br> -->
      <!--   The five agents will be shown in the "Algo" dropdown menu. Simply select one of them and press enter, and a game will begin. <br> -->
      <!--   Each game will last 40 seconds. Your goal is to score as many points as you can.<br> -->
      <!--   <br> -->
      <!--   You will use Arrow keys to move your agent (the blue chef), and Space bar to interact with objects.<br> -->
      <!--   To score points, you and the AI agent will need to place 3 onions in the stove, wait for the red ticker to tick to 20, and then put<br> -->
      <!--   the cooked onions on a plate and serve it to the grey square.<br> -->
      <!--   It's much easier to understand the game by watching <a href='https://drive.google.com/file/d/1hfcgIWDA6lWFw3cNTyiW3vKDksj9u_qd/view' target="_blank">this video</a>. (If the video doesn't play, you may have to allow third-party cookies.)<br> -->
      <!--   You will score 20 points after you successfully serve a dish. Try to serve as many dishes as you can!<br> -->
      <!--   <br> -->
      <!--   After each game ends you will see a reminder of how many games you still need to play with each agent.<br> -->
      <!--   <b>Please play with the agents in the order of the dropdown menu!</b><br> -->

      <!-- <p>After completing 2 games with an agent on a specific layout, <b> please fill out <a href="https://forms.gle/9jXt8zacHVsjjwsu7" target="_blank" rel="noopener noreferrer">this Google form</a> </b> and sign in with your Stanford email. In total, there are 8 sections in the form since there are 2 layouts and 4 AI agents (algo0 to algo3). Note that you should still play 2 games on each layout with the "No AI" algo selected to familiarize yourself with the environment, but we will not be asking for responses on those sections in the form.</p> -->
      <!-- After you have played TWO games with each agent, the Prolific completion code will be shown to you.<br> -->
      <p>
      <!-- <b>If you repeatedly score 0 points your submission may be rejected. If you score 40 points often enough you may receive a bonus payment.</b> --><br>
      Good luck and have fun!<br>
      
      </p>
      
      <h2>Check your understanding</h2>
      <ol>
        <li>I have read the instructions and watched the intro video.<br />
          <input type="radio" name="q0" id="q0_option1" value="q0_option1" onclick="checkAnswers()" />
          <label for="q0_option1">Yes.</label><br>
          <input type="radio" name="q0" id="q0_option2" value="q0_option2" onclick="checkAnswers()" />
          <label for="q0_option2">No.</label><br>
        </li>
	<!-- <li>I have the Google form open in another tab or window, and I will fill out the corresponding section after playing 2 games in a particular configuration<br /> -->
        <!--   <input type="radio" name="g0" id="g0_option1" value="g0_option1" onclick="checkAnswers()" /> -->
        <!--   <label for="g0_option1">Yes.</label><br> -->
        <!--   <input type="radio" name="g0" id="g0_option2" value="g0_option2" onclick="checkAnswers()" /> -->
        <!--   <label for="g0_option2">No.</label><br> -->
        <!-- </li> -->
        <li>Which of the following is true?<br />
          <input type="radio" name="q1" id="q1_option1" value="q1_option1" onclick="checkAnswers()" />
          <label for="q1_option1">Arrow keys to move my agent, Space bar to interact with objects.</label><br>
          <input type="radio" name="q1" id="q1_option2" value="q1_option2" onclick="checkAnswers()" />
          <label for="q1_option2">Mouse to move my agent, Enter to interact with objects.</label><br>
        </li>
        <li>Which of the following is true?<br />
          <input type="radio" name="q2" id="q2_option1" value="q2_option1" onclick="checkAnswers()" />
          <label for="q2_option1">I have to play with each algo once. I have to use the dropdown menu to select the agent I am playing with.</label><br>
          <input type="radio" name="q2" id="q2_option2" value="q2_option2" onclick="checkAnswers()" />
          <label for="q2_option2">I have to play with each algo twice. I have to use the dropdown menu to select the agent I am playing with.</label><br>
          <input type="radio" name="q2" id="q2_option3" value="q2_option3" onclick="checkAnswers()" />
          <label for="q2_option3">I have to play with each algo three times. I have to use the dropdown menu to select the agent I am playing with.</label><br>
        </li>
      </ol>
      <br />
      <center><form action="javascript:reveal()" method="GET">
          Correctly answer the questions above to activate the start button.<br />Please enter your Prolific ID.<br />
          <input type="hidden" name="env" value="fetch" />
          <input type="hidden" name="agent" value="combined" />
          SUNET ID: <input type="text" name="prolificID" id="prolificID" disabled /><br>
          <input type="submit" value="Start" id="startButton" disabled />
      </form></center>
    </div>

    <script>
      window.onload = checkAnswers();
      function checkAnswers() {
          if (document.getElementById('q0_option1').checked // && document.getElementById('g0_option1').checked
	      && document.getElementById('q1_option1').checked && document.getElementById('q2_option2').checked) {
              document.getElementById('prolificID').disabled = false;
              document.getElementById('startButton').disabled = false;
          }
          else {
              document.getElementById('prolificID').value = "";
              document.getElementById('prolificID').disabled = true;
              document.getElementById('startButton').disabled = true;
          }
      }
      function reveal() {
          if (document.getElementById('prolificID').value != "") {
              document.getElementById('q0_option1').disabled = true;
              document.getElementById('q0_option2').disabled = true;
              // document.getElementById('g0_option1').disabled = true;
              // document.getElementById('g0_option2').disabled = true;
              document.getElementById('q1_option1').disabled = true;
              document.getElementById('q1_option2').disabled = true;
              document.getElementById('q2_option1').disabled = true;
              document.getElementById('q2_option2').disabled = true;
              document.getElementById('q2_option3').disabled = true;
	      
              document.getElementById('prolificID').disabled = true;
	      document.getElementById('prolificID').blur();
              document.getElementById('startButton').disabled = true;
              document.getElementById('maindiv').style.display = 'initial';
              
              
              // var algoform = document.getElementById('algo');
              // for (var i = algoform.children.length - 1; i >= 0; i--) {
              //     algoform.appendChild(algoform.children[(Math.random() * i | 0]);
              // }
              // algoform.selectedIndex = 0;
          }
      }
      
      function blurLayout() {
	  document.getElementById('layout').blur();
      }

      function blurAlgo() {
	  document.getElementById('algo').blur();
        }

        window.addEventListener("keydown", function(e) {
        if(["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].indexOf(e.code) > -1) {
        e.preventDefault();
        }
        }, false);
      
    </script>


    <div id='maindiv' style="display: none;">
      <form>
	<div class="container">
	  <div class="row text-center">
	    <div class="form-group col-lg-3">
	      <label for="playerZero" style="color:#1E6A9E">Player 1</label>
	      <select class="form-control" id="playerZero" <!-- disabled -->>
		<option value="human">Human Keyboard Input</option>
		<option value="ai">AI agent</option>
	      </select>
	    </div>
	    <div class="form-group col-lg-3">
	      <label for="playerOne" style="color:#44956B">Player 2</label>
	      <select class="form-control" id="playerOne" <!-- disabled -->>
		<option value="ai">AI agent</option>
		<option value="human">Human Keyboard Input</option>
	      </select>
	    </div>
	    <div class="form-group col-lg-2">
	      <label for="layout">Layout</label>
	      <select class="form-control" id="layout">
            <!-- <option value="five_by_five" onclick="blurLayout()">5x5</option> -->
            <option value="simple" onclick="blurLayout()">Cramped Room (simple)</option>
		    <option value="random1" onclick="blurLayout()">Coordination Ring (random1)</option>
            <!-- <option value="random3" onclick="blurLayout()">random3</option> -->
            <!-- <option value="scenario1_s" onclick="blurLayout()">scenario1_s</option> -->
		<!-- <option value="uindent_s">Asymmetric Advantages (unident_s)</option> -->
		<!-- <option value="random0">Forced Coordination (random0)</option> -->
		<!-- <option value="random3">Counter Circuit (random3)</option> -->
	      </select>
	    </div>
	    <div class="form-group col-lg-2">
	      <label for="gameTime">Game Length (sec)</label>
	      <input type="number" id="gameTime" value="40" min="1" max="1800" disabled>
	    </div>
	    <div class="form-group col-lg-2">
	      <label for="algo">Algo</label>
	      <select class="form-control" id="algo">
		<option value="BLANK" onclick="blurAlgo()">No AI</option>
		<option value="SP" onclick="blurAlgo()">AI S<!-- (SP) --></option>
		<option value="MP" onclick="blurAlgo()">AI M<!-- (MP) --></option>
		<option value="ADAP" onclick="blurAlgo()">AI D<!-- (ADAP) --></option>
		<option value="XP" onclick="blurAlgo()">AI X<!-- (XP) --></option>
	      </select>
	    </div>
	    <!-- <div class="form-group col-lg-2">
		 <label for="layout">Deterministic?</label>
		 <input type="checkbox" id="deterministic" name="deterministic">
	    </div> -->
	    <!-- <div class="form-group col-lg-2">
		 <label for="layout">Automatically Save Game Trajectories?</label>
		 <input type="checkbox" id="saveTrajectories" name="saveTrajectories">
	    </div> -->
	    
	  </div>
	</div>
      </form>
      <!-- <h4 class="text-center"><a href="./instructions">Instructions</a></h4><h4 class="text-center"><a href="./replay">Replay Trajectories</a></h4>  -->
      <div id="overcooked" class="text-center"></div>
      <div id="control" class="text-center"></div>
      <div id="record" class="text-center"></div>
    </div>
    <div style="padding: 100px;"></div>

    <noscript>
      <h1>Warning: Javascript seems to be disabled</h1>
      <p>This website requires that Javascript be enabled on your browser.</p>
      <p>Instructions for enabling Javascript in your browser can be found 
	<a href="http://support.google.com/bin/answer.py?hl=en&answer=23852">here</a></p>
    </noscript>
  </body>
</html>
